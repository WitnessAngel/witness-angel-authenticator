
<ThinTwoLineAvatarIconListItem@TwoLineAvatarIconListItem>
    _height: dp(60)

<UserKeyStoreListItem@ThinTwoLineAvatarIconListItem>:
    text: app.tr._("User Profile")
    secondary_text: app.tr._("Stored inside system disk")
    #tertiary_text: app.tr._("fit more text than usual")

    IconLeftWidget:
        icon: "account-box"

<OpenFolderButton@IRightBodyTouch+MDRectangleFlatIconButton>:
    text: app.tr._("Find")
    icon: "file-find-outline"

<FolderKeyStoreListItem>:
    #_height: dp(60)

    selected_path: None
    text: app.tr._("Custom authenticator location")
    secondary_text: str(self.selected_path) if self.selected_path else app.tr._("Please select a folder")
    #tertiary_text: app.tr._("fit more text than usual2")

    on_size:
        self.ids._right_container.width = open_folder_btn.width
        self.ids._right_container.x = open_folder_btn.width
        self.ids._right_container.height = open_folder_btn.height
        self.ids._right_container.y = root.y + root.height/2 - open_folder_btn.height/2 # - dp(10)

    IconLeftWidget:
        icon: "folder"
    OpenFolderButton:
        id: open_folder_btn


<AuthenticatorTesterContent@MDBoxLayout>
    orientation: "vertical"
    spacing: "12dp"
    size_hint_y: None
    height: "80dp"

    MDLabel:
        text: app.tr._("Test integrity and passphrase of authenticator.")
    MDTextField:
        id: tester_passphrase
        hint_text: app.tr._("Passphrase")


<KeyringSelectorScreen>:

    on_pre_enter: root.refresh_keyring_list()

    MDBoxLayout:

        orientation: "vertical"

        ScrollView:
            orientation: "vertical"

            MDGridLayout:
                cols: 1

                MDToolbar:
                    title: app.tr._("Manage Authenticators")
                    right_action_items: [["refresh", lambda x: root.refresh_keyring_list()], ["help-circle-outline", lambda x: root.display_help_popup()]]

                ScrollView:
                    #size_hint: 1, 0.3
                    #size_hint_max_y: dp(300)
                    #height: dp(300)
                    #size_hint_min_y: dp(200)
                    #size_hint_max_y: dp(300)

                    bar_width: 5
                    bar_inactive_color: self.bar_color

                    #MDList:
                    #    padding:[20,0,0,0]
                    #    id: scroll
                    #    #bg_color: [1, 0, 0, 1]
                    MDList:
                        id: authentication_device_list
                        #spacing: "12dp"
                        #overlay_color: app.overlay_color[:-1] + [.2]
                        #icon_bg_color: app.overlay_color
                        #on_selected: app.on_selected(*args)
                        #on_unselected: app.on_unselected(*args)
                        #on_selected_mode: app.set_selection_mode(*args)

                #ScrollView:
                #    size_hint: 1, 0.7
                #    size_hint_max_y: dp(300)

                MDBoxLayout:
                    height: dp(40)
                    size_hint_y: None

                    #md_bg_color: [1, 0, 0, 1]
                    md_bg_color: app.theme_cls.bg_darkest
                    line_color: [0.2, 0.2, 0.2, 1]

                    MDIcon:
                        icon: root.AUTHENTICATOR_INITIALIZATION_STATUS_ICONS[root.authenticator_status] # "language-python"
                        halign: "center"
                        width: dp(90)
                        size_hint_x: None

                    MDLabel:
                        text: root.get_authenticator_status_message(root.authenticator_status)
                        halign: "left"

                ScrollView:
                    id: scrlv
                    TextInput:  #MDLabel:
                        id: authentication_device_information
                        readonly: True
                        padding: [10,10]
                        #border: [4, 4, 4, 4]
                        text: "MDLabel\nsdsdsdsdqsd\nqsdqsd\nqsdqsd\nqsdqsdqsd\nqsdqsds\nqsdqsdqd\nqsdqsdqsd\nsddazveg\nzerzerzero\njlfff\nzezerzer\naldjs\nzzzzzzzzzzz\naaaaaaaaaaa\nfffff\nsdkazhazkdz\nMDBOTTOM"

                        halign: "left"
                        #valign: "top"
                        #theme_text_color: "Error"
                        #md_bg_color: app.theme_cls.bg_dark

                        #size_hint_y: None
                        #height: dp(150)
                        #text_size: self.width, None
                        #height: self.texture_size[1]
                        size_hint: 1, None
                        height: max( (len(self._lines)+1) * self.line_height, scrlv.height)

                MDGridLayout:
                    id: authenticator_actions_create
                    cols: 2
                    ###adaptive_height: True if root.authenticator_status else False
                    size_hint_x: 1
                    size_hint_y: None
                    height: self.minimum_height # if root.authenticator_status is False else 0
                    disabled: root.authenticator_status is not False
                    #opacity: 1 if root.authenticator_status is False else 0

                    #Widget:

                    MDRectangleFlatIconButton:
                        anchor_x: "right"
                        halign: "center"
                        icon: "account-key-outline"
                        text: "Initialize"
                        size_hint_x: 1
                        on_press: root.manager.current = "authenticator_creation_screen"

                    MDRectangleFlatIconButton:
                        icon: "database-import-outline"
                        text: "Import"
                        size_hint_x: 1
                        on_press: root.archive_chooser_open()

                    #Widget:

                MDGridLayout:
                    id: authenticator_actions_modify
                    cols: 2
                    size_hint_x: 1
                    size_hint_y: None
                    height: self.minimum_height # if root.authenticator_status else 0
                    disabled: root.authenticator_status is not True
                    #opacity: 1 if root.authenticator_status else 0

                    MDRectangleFlatIconButton:
                        icon: "database-export-outline"
                        text: "Export"
                        size_hint_x: 1
                        on_press: root.export_authenticator_to_archive()

                    MDRectangleFlatIconButton:
                        icon: "crosshairs-question"
                        text: "Check"
                        size_hint_x: 1
                        on_press: root.show_checkup_dialog()

                    MDRectangleFlatIconButton:
                        icon: "delete-alert-outline"
                        text: "Destroy"
                        size_hint_x: 1
                        on_press: root.show_authenticator_destroy_confirmation_dialog()





        #canvas.before:
        #    Color:
        #        rgba: app.COLORS.DARKEST_BLUE
        #    Rectangle:
        #        pos: self.pos
        #        size: self.size

        #AnchorLayout:
        #    padding: [0,10]
        #    anchor_x: 'center'
        #    anchor_y: 'top'
        #    size_hint: 1, 0.3
        #    MDToolbar:
        #        title:"Select USB device to be initialized with crypto keys"
        #        size_hint: 1, 1
        #        #md_bg_color: app.COLORS.DARKEST_BLUE
        #        elevation: 2

        #GridLayout:
        #    cols:2
        #    rows: 3
        #    GridLayout:
        #        size_hint: 1, 1
        #        rows:5
        #        id: grid
        #        FloatLayout:  # what is this?
        #            pos:(20, 20)
        #            id: barProgressWIP
        #            size_hint: 1, 0.1

            #AnchorLayout:
            #    padding: [0, 20, 20, 0]
            #    size_hint: 0.5, 1

            #    Button:
            #        id: btn_refresh
            #        #background_color: app.COLORS.BUTTON_BACKGROUND
            #        #color: app.COLORS.DARKEST_BLUE
            #        text: "Refresh"
            #        size: 150, 50
            #        size_hint: None, None
            #        on_release:
            #            app.list_detected_devices()
            #    #MDRectangleFlatButton:
            #    #    text:"Hello, World"
            #    #    pos_hint: {"center_x": 0.5, "center_y": 0.5}

            #GridLayout:
            #    rows:3
            #    size_hint: 0.4, 0.3
            #    AnchorLayout:
            #        padding: [20,20]
            #        size_hint: 0.4, 0.3
            #        id: status_title_layout
            #    AnchorLayout:
            #        padding: [20,20]
            #        size_hint: 0.4, 0.3
            #        id: status_message_layout


